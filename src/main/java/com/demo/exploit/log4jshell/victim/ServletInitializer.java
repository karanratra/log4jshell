package com.demo.exploit.log4jshell.victim;

import org.springframework.boot.builder.SpringApplicationBuilder;
import org.springframework.boot.web.servlet.support.SpringBootServletInitializer;

/**
 * This class binds Servlet, Filter and ServletContextInitializer beans from the application context to the server.
 * @author karanratra on 12/20/21
 */
public class ServletInitializer extends SpringBootServletInitializer {

    @Override
    protected SpringApplicationBuilder configure(SpringApplicationBuilder application) {
        //This value is set to TRUE by default in the Java versions(JDK/JREs) older than any of the following versions : 6u211, 7u201, 8u191, 11.0.1
        //We are setting this property to TRUE, inorder to show the Log4J Exploitation
        System.setProperty("com.sun.jndi.ldap.object.trustURLCodebase", Boolean.TRUE.toString());
        System.out.println("com.sun.jndi.ldap.object.trustURLCodebase : " + System.getProperty("com.sun.jndi.ldap.object.trustURLCodebase"));
        return application.sources(Log4jShellApplication.class);
    }

}
